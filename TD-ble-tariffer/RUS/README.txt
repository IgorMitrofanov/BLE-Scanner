-------------------
Описание программы:
-------------------

Программа TD-BLE-tariffer представляет собой BLE сканнер-сборщик рекламных (advertising) пакетов и автоматической тарировки верхнего (H) и нижнего (L)
уровней для TD-датчиков производимых компанией Escort Monitoring Systems с функцией записи отчета в MS Excel.

-----------------------
Поддерживаемые датчики:
-----------------------

1. TD.

---------------------
Требования к системе:
---------------------

1. Windows 10, версии 16299 (Fall Creators Update) или выше;
2. Python 3.11 или выше;
	2.1. Для установки Python последней версии перейдите по ссылке (при установке поставить флаг "Add python.exe to Path"): https://www.python.org/downloads/
	2.2  Инструкция для установки pip в переменные среды: https://setiwik.ru/kak-ustanovit-pip-dlya-upravleniya-paketami-python-v-windows/ 
3. Bluetooth 4.0 или выше;
4. При первом запуске программы требуется доступ в интернет. При первом запуске программа устанавливает свои зависимости и закрывается, необходим повторный запуск.

--------------------
Работа с программой:
--------------------

1. При запуске main.py файла появляется вспомогательное окно "Установка параметров сканирования:", где необходимо ввести:
	1.1 Время сканирования в секундах (принимаются только целочисленные значения);
	1.2 Начальный серийный номер - серийный номер первого датчика;
	1.3 Конечный серийный номер - серийный номер последнего датчика;
	1.4 При необходимости выбрать функцию "Создать отчет" для генерации отчета в MS Excel;
	1.5 Если функция "Создать отчет" выбрана, разблокируются клавиша для выбора пути сохранения отчета: "Путь к отчету";
	1.6 Нажатие клавиши "Перейти в режим сканирования и тарировки" закроет вспомогательное окно с выбором параметров и перейдет в консольный режим;
2. В консольном режиме работы производится поиск запрошенных устройств в динамическом режиме, с выводом на экран. При поиске возможны два исхода:
	2.1 Все устройства найдены. Появляется сообщение зеленого цвета: "All devices have been found.", после чего если функция записи отчета 
	    включена, то программа сообщит что файл отчета записан. Пример: "Файл записан в директорию C:/Users/User/Desktop/ с именем tariffy_X-Y.xlsx" (где X - начальный серийный номер, Y - конечный серийный номер). Если
	    функция записи отчета не была выбрана - появится предупреждение красным текстом, говорящее о том, что функция записи отчета не была
	    выбрана: "Предупреждение: выбран режим без записи отчета".
	2.2 Истечение времени сканирования - найдены не все устройства: "Время сканирования вышло. Найдены не все устройства.". К тому же, следующей строкой 
	    программа выведет все не найденные имена устройств. Пользователю будет предложено начать поиск не найденных устройств при
	    предыдущем сканировании и изменить время сканирования при необходимости.
3. В отчете проводится четыре теста: 
	3.1 Если температура проверяемого датчика отличается от средней по всем проверенным более чем на 5 единиц в большую или меньшую сторону - вся строка 
	    помечается красным цветом, в столбце "Причина отбраковки" пишется соответствующая причина.
	3.2 Если текущий уровень топлива после тарировки больше 15 единиц - вся строка помечается красным цветом, в столбце "Причина отбраковки" пишется 
	    соответствующая причина.
	3.3 Если верхний (H) уровень калибровки больше, чем 43000 - вся строка помечается красным цветом, в столбце "Причина отбраковки" пишется 
	    соответствующая причина.
	3.4 Если нижний (L) уровень калибровки меньше, чем 20000 - вся строка помечается красным цветом, в столбце "Причина отбраковки" пишется 
	    соответствующая причина.
	

--------------------------------------------------------------------
Обновление 07.07.2023 декстоп и консольной версии TD-BLE-тарировщика
--------------------------------------------------------------------
	
	1. Устранена проблема с зависанием программы при подключении и калибровки устройств;
	2. Галочка для создания отчета убрана, теперь отчет генерируется всегда;
	3. Устранена ошибка при подсветке брака в отчете;
	4. Улучшена логика работы программы, код облегчен и оптимизирован;
	5. Добавлена документация к коду;
